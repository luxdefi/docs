<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-overview/getting-started/lux-consensus">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-126268251-10","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>


<link rel="search" type="application/opensearchdescription+xml" title="Lux Network Documentation" href="/opensearch.xml">
<script src="scripts/intercom-app.js"></script>
<script src="scripts/intercom-scripts.js"></script><title data-rh="true">Lux Blockchain Consensus | Lux Network Documentation</title><meta data-rh="true" property="og:image" content="https://docs.lux.network/img/Lux-OG-Image.png?force-reload-1"><meta data-rh="true" name="twitter:image" content="https://docs.lux.network/img/Lux-OG-Image.png?force-reload-1"><meta data-rh="true" property="og:url" content="https://docs.lux.network/overview/getting-started/lux-consensus"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:description" content="Lux is the only regulatrd smart contracts platform in the blockchain industry, and has the most value securing its activity of any proof-of-stake protocol."><meta data-rh="true" name="twitter:title" content="Developer Documentation and Tutorials for Lux Network"><meta data-rh="true" name="keywords" content="Developer Documentation and Tutorials for Lux Network"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Lux Blockchain Consensus | Lux Network Documentation"><meta data-rh="true" name="description" content="Consensus is the task of getting a group of computers to come to an agreement on a decision. Lux is a new consensus protocol that is scalable, robust, and decentralized."><meta data-rh="true" property="og:description" content="Consensus is the task of getting a group of computers to come to an agreement on a decision. Lux is a new consensus protocol that is scalable, robust, and decentralized."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.lux.network/overview/getting-started/lux-consensus"><link data-rh="true" rel="alternate" href="https://docs.lux.network/overview/getting-started/lux-consensus" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.lux.network/overview/getting-started/lux-consensus" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://Z0LRBDMQFT-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.ab583772.css">
<link rel="preload" href="/assets/js/runtime~main.bb3b2830.js" as="script">
<link rel="preload" href="/assets/js/main.199c8d31.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/LuxLogo.svg" alt="Lux Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/LuxLogoWhite.svg" alt="Lux Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Overview</a><a class="navbar__item navbar__link" href="/quickstart">Quick Start</a><a class="navbar__item navbar__link" href="/dapps/launch-your-ethereum-dapp">DApps</a><a class="navbar__item navbar__link" href="/subnets">Subnets</a><a class="navbar__item navbar__link" href="/apis/luxd">APIs</a><a class="navbar__item navbar__link" href="/nodes">Nodes</a><a class="navbar__item navbar__link" href="/specs/coreth-arc20s">Specs</a><a class="navbar__item navbar__link" href="/community">Community</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/overview/getting-started/lux-consensus" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/">Getting Started</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/overview/getting-started/lux-platform">Lux Platform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/overview/getting-started/lux-consensus">Lux Blockchain Consensus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href="https://docs.lux.network/whitepapers" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK" tabindex="0">Whitepapers<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/overview/projects">Projects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a href="https://github.com/luxdefi/audits" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK">Audits<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Getting Started</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Lux Blockchain Consensus</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Lux Blockchain Consensus</h1><p>Consensus is the task of getting a group of computers to come to an agreement on a decision. Computers can reach a consensus by following a set of steps called a consensus protocol. Lux is a new consensus protocol that is scalable, robust, and decentralized. It has low latency and high throughput. It is energy efficient and does not require special computer hardware. It performs well in adversarial conditions and is resilient to &quot;51% attacks.&quot; This document explains the Lux consensus protocol. The whitepaper is <a href="https://www.lux.network/whitepapers" target="_blank" rel="noopener noreferrer">here.</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="video">Video<a class="hash-link" href="#video" title="Direct link to heading">​</a></h2><div align="center"><b>Deep Dive on the Lux Protocol</b></div><iframe src="https://www.youtube.com/embed/ZUF9sIu-D_k" width="100%" height="480px" title="Deep Dive on the Lux Protocol" class="video-container" display="initial" position="relative" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"></iframe><h2 class="anchor anchorWithStickyNavbar_LWe7" id="intuition">Intuition<a class="hash-link" href="#intuition" title="Direct link to heading">​</a></h2><p>First, let&#x27;s develop some intuition about the protocol. Imagine a room full of people trying to agree on what to get for lunch. Suppose it&#x27;s a binary choice between pizza and barbecue. Some people might initially prefer pizza while others initially prefer barbecue. Ultimately, though, everyone&#x27;s goal is to achieve <strong>consensus</strong>.</p><p>Everyone asks a random subset of the people in the room what their lunch preference is. If more than half say pizza, the person thinks, &quot;Ok, looks like things are leaning toward pizza. I prefer pizza now.&quot; That is, they adopt the <em>preference</em> of the majority. Similarly, if a majority say barbecue, the person adopts barbecue as their preference.</p><p>Everyone repeats this process. Each round, more and more people have the same preference. This is because the more people that prefer an option, the more likely someone is to receive a majority reply and adopt that option as their preference. After enough rounds, they reach consensus and decide on one option, which everyone prefers.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="snowball">Snowball<a class="hash-link" href="#snowball" title="Direct link to heading">​</a></h2><p>The intuition above outlines the Snowball Algorithm, which is a building block of Lux consensus. Let&#x27;s review the Snowball algorithm.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="parameters">Parameters<a class="hash-link" href="#parameters" title="Direct link to heading">​</a></h3><ul><li><em>n</em>: number of participants</li><li><em>k</em> (sample size): between 1 and <em>n</em></li><li>α (quorum size): between 1 and <em>k</em></li><li>β (decision threshold): <!-- -->&gt;<!-- -->= 1</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="algorithm">Algorithm<a class="hash-link" href="#algorithm" title="Direct link to heading">​</a></h3><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">preference := pizza</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">consecutiveSuccesses := 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">while not decided:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ask k random people their preference</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if &gt;= α give the same response:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    preference := response with &gt;= α</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if preference == old preference:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      consecutiveSuccesses++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      consecutiveSuccesses = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  else:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    consecutiveSuccesses = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if consecutiveSuccesses &gt; β:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    decide(preference)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="algorithm-explained">Algorithm Explained<a class="hash-link" href="#algorithm-explained" title="Direct link to heading">​</a></h3><p>Everyone has an initial preference for pizza or barbecue. Until someone has <em>decided</em>, they query <em>k</em> people (the sample size) and ask them what they prefer. If α or more people give the same response, that response is adopted as the new preference. α is called the <em>quorum size</em>. If the new preference is the same as the old preference, the <code>consecutiveSuccesses</code> counter is incremented. If the new preference is different then the old preference, the <code>consecutiveSuccesses</code> counter is set to <code>1</code>. If no response gets a quorum (an α majority of the same response) then the <code>consecutiveSuccesses</code> counter is set to <code>0</code>.</p><p>Everyone repeats this until they get a quorum for the same response β times in a row. If one person decides pizza, then every other person following the protocol will eventually also decide on pizza.</p><p>Random changes in preference, caused by random sampling, cause a network preference for one choice, which begets more network preference for that choice until it becomes irreversible and then the nodes can decide.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>For a great visualization, check out <a href="https://tedyin.com/archive/snow-bft-demo/#/snow" target="_blank" rel="noopener noreferrer">this demo</a> from Lux Partners&#x27; Co-Founder Ted Yin.</p></div></div><p>In our example, there is a binary choice between pizza or barbecue, but Snowball can be adapted to achieve consensus on decisions with many possible choices.</p><p>The liveness and safety thresholds are parameterizable. As the quorum size, α, increases, the safety threshold increases, and the liveness threshold decreases. This means the network can tolerate more byzantine (deliberately incorrect, malicious) nodes and remain safe, meaning all nodes will eventually agree whether something is accepted or rejected. The liveness threshold is the number of malicious participants that can be tolerated before the protocol is unable to make progress.</p><p>These values, which are constants, are quite small on the Lux Network. The sample size, <em>k</em>, is <code>20</code>. So when a node asks a group of nodes their opinion, it only queries <code>20</code> nodes out of the whole network. The quorum size, α, is <code>14</code>. So if <code>14</code> or more nodes give the same response, that response is adopted as the querying node&#x27;s preference. The decision threshold, β, is <code>20</code>. A node decides on choice after receiving <code>20</code> consecutive quorum (α majority) responses.</p><p>Snowball is very scalable as the number of nodes on the network, <em>n</em>, increases. Regardless of the number of participants in the network, the number of consensus messages sent remains the same because in a given query, a node only queries <code>20</code> nodes, even if there are thousands of nodes in the network.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="dags-directed-acyclic-graphs">DAGs (<strong>D</strong>irected <strong>A</strong>cyclic <strong>G</strong>raphs)<a class="hash-link" href="#dags-directed-acyclic-graphs" title="Direct link to heading">​</a></h2><p>Now let&#x27;s introduce a data structure called a DAG or Directed Acyclic Graph. A DAG gives a <strong>partial ordering</strong> of decisions. For example, check out the DAG in this diagram:</p><p><img loading="lazy" alt="Basic DAG" src="/assets/images/cons-01-Frame16-6cb8406242bb7864f7a4bf4f7eb9d90e.png" width="1394" height="876" class="img_ev3q"></p><p><strong>a</strong> is before <strong>b</strong>. <strong>b</strong> is before <strong>d</strong>. <strong>c</strong> is before <strong>e</strong>. Transitively, we can say that <strong>a</strong> comes before <strong>e</strong>. However, since this is a partial ordering: for some elements, ordering is not defined. For example, both <strong>b</strong> and <strong>c</strong> are after <strong>a</strong> but there is no notion of whether <strong>b</strong> is before or after <strong>c</strong>.</p><p>Two additional DAG related concepts are <strong>ancestors</strong> and <strong>descendants</strong>. Ancestors are any nodes in the DAG which you can draw a line up to. For example, the ancestors of <strong>d</strong> are <strong>a</strong>, <strong>b</strong>, and <strong>c</strong>. The ancestors of <strong>e</strong> are <strong>a</strong> and <strong>c</strong>. Descendants are the opposite of ancestors. The descendants of <strong>a</strong> are <strong>b</strong>, <strong>c</strong>, <strong>d</strong>, and <strong>e</strong>. The descendant of <strong>b</strong> is <strong>d</strong>.</p><p>Both Bitcoin and Ethereum, for example, have a linear chain where every block has one parent and one child. Lux uses a DAG to store data rather than a linear chain. Each element of the DAG may have multiple parents. The parent-child relationship in the DAG does not imply an application-level dependency.</p><p>In a consensus protocol, the name of the game is to prevent the inclusion of <strong>conflicting transactions</strong> into the DAG. Conflicts are application-defined. Different applications will have different notions about what it means for two transactions to conflict. For example, in a P2P payment system, transactions that consume the same UTXO (<a href="https://en.wikipedia.org/wiki/Unspent_transaction_output" target="_blank" rel="noopener noreferrer">Unspent Transaction Output</a>) would conflict. In Lux every transaction belongs to a <strong>conflict set</strong> which consists of conflicting transactions. Only one transaction in a conflict set can be included in the DAG. Each node <strong>prefers</strong> one transaction in a conflict set.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="working-example">Working Example<a class="hash-link" href="#working-example" title="Direct link to heading">​</a></h2><p>Suppose we have an Lux network running with the following parameters. The sample size, <em>k</em>, is <code>4</code>. The quorum size, α, is <code>3</code>. The number of consecutive success, β, is <code>4</code>.</p><p><img loading="lazy" alt="Working example 1" src="/assets/images/cons-02-Consensus_Doc_txY-c635f17a166090366b64777cf6c03192.png" width="1401" height="880" class="img_ev3q"></p><p>A node finds out about a new transaction <strong>Y</strong>. It queries the network based on the above parameters. It queries <em>k</em> (<code>4</code>) validators and asks, &quot;Do you prefer this transaction?&quot; It gets back responses—three of them say <strong>yes</strong> and one of them says <strong>no</strong>. The quorum size, α, is <code>3</code> so there is an α majority (quorum) of yes responses. Now the node updates its DAG.</p><p><img loading="lazy" alt="Working example 2" src="/assets/images/cons-03-Consensus_Doc_txY-6-4c78cae1817b9d7d2f7dc11466c225f5.png" width="1400" height="880" class="img_ev3q"></p><p>If a node gets an α majority response for a transaction then you give that transaction a <strong>chit</strong>, which is a boolean that says, &quot;When I queried the network about this transaction, an α majority said that they preferred it.&quot; In our example, transaction <strong>Y</strong> gets a chit.</p><p>There is also a notion of <strong>confidence</strong>, which is the sum of a vertex&#x27;s chit plus the sum of its descendants&#x27; chits. For example, transaction <strong>V</strong> has a chit. It also has three descendants which have a chit so its confidence is increased from <code>3</code> to <code>4</code>. Similarly, transactions <strong>W</strong> and <strong>X</strong> both have a chit and they both have a descendant with a chit, so they each have confidence <code>2</code>. Transaction <strong>Y</strong> has confidence <code>1</code>.</p><p><strong>Consecutive successes</strong> are the same as in Snowball. It&#x27;s the number of times that a transaction, or a descendant of the transaction, received a successful α majority query response. Previously, transaction <strong>V</strong> had <code>3</code> consecutive successes, itself and its two children, and now it has <code>4</code> consecutive successes with transaction <strong>Y</strong>. Similarly for transactions <strong>W</strong> and <strong>X</strong>.</p><p><img loading="lazy" alt="Working example 3" src="/assets/images/cons-04-Consensus_Doc_txY-2-abeba67987c75f19f0b4e2167a6a24a0.png" width="1400" height="880" class="img_ev3q"></p><p>In this example we the acceptance threshold, β, is <code>4</code>. Transaction <strong>V</strong> has <code>4</code> consecutive success so it&#x27;s <strong>accepted</strong>. This node is sure that every other correct node will eventually accept this transaction.</p><p><img loading="lazy" alt="Working example 4" src="/assets/images/cons-05-Consensus_Doc_txY-3-adc63656c404507ce708d0da51fb9499.png" width="1401" height="880" class="img_ev3q"></p><p>Now suppose the node learns about transaction <strong>Y&#x27;</strong> which conflicts with transaction <strong>Y</strong>. It follows the same steps as before and subsamples <em>k</em> (<code>4</code>) validators and asks if they prefer transaction <strong>Y&#x27;</strong>. In this case, two of them say that they prefer <strong>Y&#x27;</strong> and two of them say that they do not prefer <strong>Y&#x27;</strong>. This time there is no α majority response, and the DAG is updated accordingly.</p><p><img loading="lazy" alt="Working example 5" src="/assets/images/cons-06-Consensus_Doc_txY-4-e991807f1bd44336201cea50361eb328.png" width="1401" height="880" class="img_ev3q"></p><p>Transactions <strong>Y</strong> and <strong>Y&#x27;</strong> are in a conflict set; only one of them can ultimately get accepted. Transaction <strong>Y&#x27;</strong> doesn&#x27;t get a chit because it didn&#x27;t get an α majority response. It has confidence <code>0</code> because it doesn&#x27;t have a chit and it doesn&#x27;t have any descendants with a chit. It has <code>0</code> consecutive successes because the previous query didn&#x27;t get an α majority response. Transaction <strong>W</strong>&#x27;s consecutive success counter goes from <code>2</code> to <code>0</code>. Its confidence is still <code>2</code>.</p><p>When a node is asked whether it prefers a given transaction, it replies yes if that transaction has the highest confidence of any transaction in the transaction&#x27;s conflict set. In this example, transaction <strong>Y</strong> has confidence <code>1</code> and transaction <strong>Y&#x27;</strong> has confidence <code>0</code> so the node prefer transaction <strong>Y</strong> to transaction <strong>Y&#x27;</strong>.</p><p><img loading="lazy" alt="Working example 6" src="/assets/images/cons-07-Consensus_Doc_txY-1-917ec3b57c7a5f73f40aa12a49e5528a.png" width="1400" height="880" class="img_ev3q"></p><p>Now the node learns about a new transaction, <strong>Z</strong>, and it does the same thing as before. It queries <em>k</em> nodes, gets back an α majority response, and updates the DAG.</p><p><img loading="lazy" alt="Working example 7" src="/assets/images/cons-08-Consensus_Doc_txY-5-a61cce61594c74b363cdd71d643e2428.png" width="1401" height="880" class="img_ev3q"></p><p>Transaction <strong>Z</strong> gets a chit. It also has a confidence of <code>1</code> and <code>1</code> consecutive success. The processing ancestors are updated, too. No transactions have <code>4</code> consecutive successes so no ancestors are accepted.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="vertices">Vertices<a class="hash-link" href="#vertices" title="Direct link to heading">​</a></h2><p>Everything discussed to this point is how Lux is described in <a href="https://assets-global.website-files.com/5d80307810123f5ffbb34d6e/6009805681b416f34dcae012_Lux%20Consensus%20Whitepaper.pdf" target="_blank" rel="noopener noreferrer">the Lux whitepaper</a>. The implementation of the Lux consensus protocol by Lux Partners (namely in LuxGo) has some optimizations for latency and throughput. The most important optimization is the use of <strong>vertices</strong>. A vertex is like a block in a linear blockchain. It contains the hashes of its parents, and it contains a list of transactions. Vertices allow transactions to be batched and voted on in groups rather than one by one. The DAG is composed of vertices, and the protocol works very similar to how it&#x27;s described above.</p><p>If a node receives a vote for a vertex, it counts as a vote for all the transactions in a vertex, and votes are applied transitively upward. A vertex is accepted when all the transactions which are in it are accepted. If a vertex contains a rejected transaction then it is rejected and all of its descendants are rejected. If a vertex is rejected, any valid transactions are re-issued into a new vertex which is not the child of a rejected vertex. New vertices are appended to preferred vertices.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="finality">Finality<a class="hash-link" href="#finality" title="Direct link to heading">​</a></h2><p>Lux consensus is probabilistically safe up to a safety threshold. That is, the probability that a correct node accepts a transaction that another correct node rejects can be made arbitrarily low by adjusting system parameters. In Nakamoto consensus protocol (as used in Bitcoin and Ethereum, for example), a block may be included in the chain but then be removed and not end up in the canonical chain. This means waiting an hour for transaction settlement. In Lux, acceptance/rejection are <strong>final and irreversible</strong> and take a few seconds.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="optimizations">Optimizations<a class="hash-link" href="#optimizations" title="Direct link to heading">​</a></h2><p>It&#x27;s not efficient for nodes to just ask, &quot;Do you prefer this vertex?&quot; when they query validators. In Lux Partners&#x27; implementation, during a query a node asks, &quot;Given that this vertex exists, which vertices do you prefer?&quot; Instead of getting back a binary yes/no, the node receives the other node&#x27;s preferred vertex set.</p><p>Nodes don&#x27;t only query upon hearing of a new transaction. They repeatedly query until there are no virtuous vertices processing. A virtuous vertex is one that has no conflicts.</p><p>Nodes don&#x27;t need to wait until they get all <em>k</em> query responses before registering the outcome of a poll. If no transaction can get an α majority then there&#x27;s no need to wait for the rest of the responses.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="validators">Validators<a class="hash-link" href="#validators" title="Direct link to heading">​</a></h2><p>If it were free to become a validator on the Lux network, that would be problematic because a malicious actor could start many, many nodes which would get queried very frequently. The malicious actor could make the node act badly and cause a safety or liveness failure. The validators, the nodes which are queried as part of consensus, have influence over the network. They have to pay for that influence with real-world value in order to prevent this kind of ballot stuffing. This idea of using real-world value to buy influence over the network is called Proof of Stake.</p><p>To become a validator, a node must <strong>bond</strong> (stake) something valuable (<strong>LUX</strong>). The more LUX a node bonds, the more often that node is queried by other nodes. When a node samples the network it&#x27;s not uniformly random. Rather, it&#x27;s weighted by stake amount. Nodes are incentivized to be validators because they get a reward if, while they validate, they&#x27;re sufficiently correct and responsive.</p><p>Lux doesn&#x27;t have slashing. If a node doesn&#x27;t behave well while validating, such as giving incorrect responses or perhaps not responding at all, its stake is still returned in whole, but with no reward. As long as a sufficient portion of the bonded LUX is held by correct nodes, then the network is safe, and is live for virtuous transactions.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="big-ideas">Big Ideas<a class="hash-link" href="#big-ideas" title="Direct link to heading">​</a></h2><p>Two big ideas in Lux are <strong>subsampling</strong> and <strong>transitive voting</strong>. Subsampling has low message overhead. It doesn&#x27;t matter if there are twenty validators or two thousand validators; the number of consensus messages a node sends during a query remains constant.</p><p><img loading="lazy" alt="Working example 8" src="/assets/images/cons-09-Consensus_Doc_txY-7-6ec982c6e2abe849e29fd0095d7b0dda.png" width="1400" height="880" class="img_ev3q"></p><p>Transitive voting, where a vote for a vertex is a vote for all its ancestors, helps with transaction throughput. Each vote is actually many votes in one. For example, in the above diagram, if a node gets a vote for vertex <strong>D</strong>, that implies a vote for all it&#x27;s ancestors; a vote for <strong>D</strong> is also a vote for <strong>A</strong>, <strong>B</strong>, and <strong>C</strong>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="loose-ends">Loose Ends<a class="hash-link" href="#loose-ends" title="Direct link to heading">​</a></h2><p>Transactions are created by users which call an API on the <a href="https://github.com/luxdefi/luxd" target="_blank" rel="noopener noreferrer">LuxGo</a> full node or create them using a library such as <a href="https://github.com/luxdefi/luxjs" target="_blank" rel="noopener noreferrer">LuxJS</a>. Vertices are created when nodes batch incoming transactions together or when accepted transactions from a rejected vertex get reissued and added to the DAG. A vertex&#x27;s parents are chosen from the virtuous frontier, which are the nodes at the tip of the DAG with no conflicts. It&#x27;s important to build on virtuous vertices because if we built on non-virtuous vertices there would be a higher chance that the node would get rejected which means there&#x27;s a higher chance it&#x27;s ancestors get rejected and we would make less progress.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="other-observations">Other Observations<a class="hash-link" href="#other-observations" title="Direct link to heading">​</a></h2><p>Conflicting transactions are not guaranteed to be live. That&#x27;s not really a problem because if you want your transaction to be live then you should not issue a conflicting transaction.</p><p>Lux works for linear chains too. The protocol is largely the same as above, but each vertex has only one parent. This gives a total ordering of vertices. This is useful for certain applications where one needs to know if a transaction came before another transaction, such as with smart contracts. Snowman is the name of Lux Partners&#x27; implementation of the Lux consensus protocol for linear chains.</p><p>If there are no undecided transactions, the Lux consensus protocol <em>quiesces</em>. That is, it does nothing if there is no work to be done. Lux is more sustainable than Proof-of-work where nodes need to constantly do work.</p><p>Lux has no leader. Any node can propose a transaction and any node that has staked LUX can vote on every transaction, which makes the network more robust and decentralized.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-do-we-care">Why Do We Care?<a class="hash-link" href="#why-do-we-care" title="Direct link to heading">​</a></h2><p>Lux is a general consensus engine. It doesn&#x27;t matter what type of application is put on top of it. The protocol allows the decoupling of the application layer from the consensus layer. If you&#x27;re building a Dapp on Lux then you just need to define a few things, like how conflicts are defined and what is in a transaction. You don&#x27;t need to worry about how nodes come to an agreement. The consensus protocol is a black box that put something into it and it comes back as accepted or rejected.</p><p>Lux can be used for all kinds of applications, not just P2P payment networks. Lux&#x27;s Primary Network has an instance of the Ethereum Virtual Machine, which is backward compatible with existing Ethereum Dapps and dev tooling. The Ethereum consensus protocol has been replaced with Lux consensus to enable lower block latency and higher throughput.</p><p>Lux is very performant. It can process thousands of transactions per second with one to two second acceptance latency.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a class="hash-link" href="#summary" title="Direct link to heading">​</a></h2><p>Lux consensus is a radical breakthrough in distributed systems. It represents as large a leap forward as the classical and Nakamoto consensus protocols that came before it. Now that you have a better understanding of how it works, check out other documentations for building game-changing Dapps and financial instruments on Lux.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/luxdefi/network-docs/edit/main/docs/overview/getting-started/lux-consensus.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/overview/getting-started/lux-platform"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Lux Platform</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/overview/projects"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Projects</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#video" class="table-of-contents__link toc-highlight">Video</a></li><li><a href="#intuition" class="table-of-contents__link toc-highlight">Intuition</a></li><li><a href="#snowball" class="table-of-contents__link toc-highlight">Snowball</a><ul><li><a href="#parameters" class="table-of-contents__link toc-highlight">Parameters</a></li><li><a href="#algorithm" class="table-of-contents__link toc-highlight">Algorithm</a></li><li><a href="#algorithm-explained" class="table-of-contents__link toc-highlight">Algorithm Explained</a></li></ul></li><li><a href="#dags-directed-acyclic-graphs" class="table-of-contents__link toc-highlight">DAGs (<strong>D</strong>irected <strong>A</strong>cyclic <strong>G</strong>raphs)</a></li><li><a href="#working-example" class="table-of-contents__link toc-highlight">Working Example</a></li><li><a href="#vertices" class="table-of-contents__link toc-highlight">Vertices</a></li><li><a href="#finality" class="table-of-contents__link toc-highlight">Finality</a></li><li><a href="#optimizations" class="table-of-contents__link toc-highlight">Optimizations</a></li><li><a href="#validators" class="table-of-contents__link toc-highlight">Validators</a></li><li><a href="#big-ideas" class="table-of-contents__link toc-highlight">Big Ideas</a></li><li><a href="#loose-ends" class="table-of-contents__link toc-highlight">Loose Ends</a></li><li><a href="#other-observations" class="table-of-contents__link toc-highlight">Other Observations</a></li><li><a href="#why-do-we-care" class="table-of-contents__link toc-highlight">Why Do We Care?</a></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://chat.lux.network" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/luxdefi" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://t.me/luxdefi" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://medium.com/luxdefi" target="_blank" rel="noopener noreferrer" class="footer__link-item">Medium<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://youtube.com/luxdefi" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://ecosystem.lux.network" target="_blank" rel="noopener noreferrer" class="footer__link-item">Ecosystem<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/luxdefi/network-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Lux Partners Limited</div></div></div></footer></div>
<script src="/assets/js/runtime~main.bb3b2830.js"></script>
<script src="/assets/js/main.199c8d31.js"></script>
</body>
</html>