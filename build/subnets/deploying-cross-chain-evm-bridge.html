<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-subnets/deploying-cross-chain-evm-bridge">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-126268251-10","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>


<link rel="search" type="application/opensearchdescription+xml" title="Lux Network Documentation" href="/opensearch.xml">
<script src="scripts/intercom-app.js"></script>
<script src="scripts/intercom-scripts.js"></script><title data-rh="true">Deploying Cross-Chain EVM &lt;-&gt; EVM Bridge | Lux Network Documentation</title><meta data-rh="true" property="og:image" content="https://docs.lux.network/img/Lux-OG-Image.png?force-reload-1"><meta data-rh="true" name="twitter:image" content="https://docs.lux.network/img/Lux-OG-Image.png?force-reload-1"><meta data-rh="true" property="og:url" content="https://docs.lux.network/subnets/deploying-cross-chain-evm-bridge"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:description" content="Lux is the only regulatrd smart contracts platform in the blockchain industry, and has the most value securing its activity of any proof-of-stake protocol."><meta data-rh="true" name="twitter:title" content="Developer Documentation and Tutorials for Lux Network"><meta data-rh="true" name="keywords" content="Developer Documentation and Tutorials for Lux Network"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Deploying Cross-Chain EVM &lt;-&gt; EVM Bridge | Lux Network Documentation"><meta data-rh="true" name="description" content="This tutorial is for demo purpose on how to build a cross-chain bridge. It is not for production use. You must take the full responsibility to ensure your bridge&#x27;s security."><meta data-rh="true" property="og:description" content="This tutorial is for demo purpose on how to build a cross-chain bridge. It is not for production use. You must take the full responsibility to ensure your bridge&#x27;s security."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.lux.network/subnets/deploying-cross-chain-evm-bridge"><link data-rh="true" rel="alternate" href="https://docs.lux.network/subnets/deploying-cross-chain-evm-bridge" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.lux.network/subnets/deploying-cross-chain-evm-bridge" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://Z0LRBDMQFT-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.ab583772.css">
<link rel="preload" href="/assets/js/runtime~main.bb3b2830.js" as="script">
<link rel="preload" href="/assets/js/main.199c8d31.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/LuxLogo.svg" alt="Lux Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/LuxLogoWhite.svg" alt="Lux Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/">Overview</a><a class="navbar__item navbar__link" href="/quickstart">Quick Start</a><a class="navbar__item navbar__link" href="/dapps/launch-your-ethereum-dapp">DApps</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/subnets">Subnets</a><a class="navbar__item navbar__link" href="/apis/luxd">APIs</a><a class="navbar__item navbar__link" href="/nodes">Nodes</a><a class="navbar__item navbar__link" href="/specs/coreth-arc20s">Specs</a><a class="navbar__item navbar__link" href="/community">Community</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/subnets/deploying-cross-chain-evm-bridge" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/subnets">Subnets Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/subnets/create-a-local-subnet">Build</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/subnets/create-a-local-subnet">Create an EVM Subnet on a Local Network</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/subnets/create-a-fuji-subnet">Create an EVM Subnet on Fuji Testnet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/subnets/deploying-subnets-on-prod">Deploying Subnets on Production Infrastructure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/subnets/setup-dfk-node">Run a Mainnet Node on DeFi Kingdoms Subnet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/subnets/deploy-a-smart-contract-on-your-evm">Deploy a Smart Contract on Your Subnet EVM Using Remix and Metamask</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/subnets/create-a-evm-blockchain-on-subnet-with-luxjs">Deploying Subnet with EVM Based Blockchain using LuxJS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/subnets/create-a-fuji-subnet-subnet-cli">Create an EVM Subnet on Fuji Testnet Using Subnet-CLI</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/subnets/customize-a-subnet">Customize</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/subnets/customize-a-subnet">Customize Your EVM-Powered Subnet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/subnets/create-a-virtual-machine-vm">Create a Virtual Machine (VM)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/subnets/lux-subnet-faucet">Tools</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/subnets/lux-subnet-faucet">Lux Subnet Faucet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/subnets/subnet-cli">Subnet CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/subnets/deploying-cross-chain-evm-bridge">Deploying Cross-Chain EVM &lt;-&gt; EVM Bridge</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/subnets/network-runner">Lux Network Runner</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/subnets/deploy-a-gnosis-safe-on-your-evm">Deploy a Gnosis Safe on Your Subnet EVM</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/subnets/spaces">Examples</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/subnets/spaces">Spaces: Experimental Implementation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/subnets/wagmi">WAGMI Subnet Demo</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a href="https://support.lux.network/en/articles/6158840-subnet-faq" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK">Subnet FAQ<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Tools</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Deploying Cross-Chain EVM &lt;-&gt; EVM Bridge</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Deploying Cross-Chain EVM &lt;-&gt; EVM Bridge</h1><div class="theme-admonition theme-admonition-warning alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p>This tutorial is for demo purpose on how to build a cross-chain bridge. It is not for production use. You must take the full responsibility to ensure your bridge&#x27;s security.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">​</a></h2><p>In this tutorial, we will be building a bridge between <strong><a href="/subnets/wagmi">WAGMI</a></strong> and <strong><a href="/quickstart/fuji-workflow">Fuji</a></strong>. This bridge will help us to transfer native <strong>WGM</strong> coin wrapped into <strong>wWGM</strong> back and forth from the WAGMI chain to the Fuji chain. Using this guide, you can deploy a bridge between any EVM-based chains for any ERC20 tokens.</p><p>The wrapped version of a native coin is its pegged ERC20 representation. Wrapping it with the ERC20 standard makes certain processes like delegated transactions much easier. You can easily get wrapped tokens by sending the native coin to the wrapped token contract address.</p><blockquote><p>WAGMI is an independent EVM-based test chain deployed on a custom Subnet on the Lux network.</p></blockquote><p>We will be using <strong>Chainsafe</strong>&#x27;s bridge repository, to easily set up a robust and secure bridge.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="workflow-of-the-bridge">Workflow of the Bridge<a class="hash-link" href="#workflow-of-the-bridge" title="Direct link to heading">​</a></h2><p>WAGMI and Fuji chains are not interconnected by default, however, we could make them communicate. Relayers watch for events (by polling blocks) on one chain and perform necessary action using those events on the other chain. This way we can also perform bridging of tokens from one chain to the other chain through the use of smart contracts.</p><p>Here is the basic high-level workflow of the bridge -</p><ul><li>Users deposit token on the Bridge contract</li><li>Bridge contract asks Handler contract to perform deposit action</li><li>Handler contract <strong>locks</strong> the deposited token in the token safe</li><li>Bridge contract emits <code>Deposit</code> event</li><li>Relayer receives the <code>Deposit</code> event from the source chain</li><li>Relayer creates a voting proposal on the destination chain to mint a new token</li><li>After threshold relayer votes, the proposal is executed</li><li>Tokens are <strong>minted</strong> to the recipient&#x27;s address</li></ul><p>Bridging tokens from source to destination chain involves the <strong>lock and mint</strong> approach. Whereas bridging tokens from destination to source chain involves <strong>burn and release</strong> approach. We cannot mint and burn tokens that we do not control. Therefore we lock them in the token safe on the source chain. And mint the corresponding token (which we will deploy and hence control) on the destination chain.</p><p><img loading="lazy" src="/assets/images/chainsafe-bridge-1-workflow-d8ad88d35b0e2b4bb21b75136bd7cf99.png" width="4504" height="3022" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="requirements">Requirements<a class="hash-link" href="#requirements" title="Direct link to heading">​</a></h2><p>These are the requirement to follow this tutorial -</p><ul><li>Add <a href="/subnets/wagmi#adding-wagmi-to-metamask">WAGMI</a> and <a href="/quickstart/fuji-workflow#set-up-fuji-network-on-metamask-optional">Fuji</a> chain on the MetaMask network</li><li>Import <code>wWGM</code> token (asset) on the WAGMI network (MetaMask). Here is the address - <code>0x3Ee7094DADda15810F191DD6AcF7E4FFa37571e4</code></li><li><code>WGM</code> coins on the WAGMI chain. Drip <code>1 WGM</code> from the <a href="https://faucet.trywagmi.xyz/" target="_blank" rel="noopener noreferrer">WAGMI Faucet</a>.</li><li><code>LUX</code> coins on the Fuji chain. Drip <code>10 LUX</code> from the <a href="https://faucet.lux.network/" target="_blank" rel="noopener noreferrer">Fuji Faucet</a></li><li>Wrapped <code>WGM</code> tokens on the WAGMI chain. Send a few <code>WGM</code> coins to the <code>wWGM</code> token address (see 2nd point), to receive the same amount of <code>wWGM</code>. Always keep some <code>WGM</code> coins, to cover transaction fees.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-environment">Setting Up Environment<a class="hash-link" href="#setting-up-environment" title="Direct link to heading">​</a></h2><p>Let&#x27;s make a new directory <code>deploy-bridge</code>, where we will be keeping our bridge codes. We will be using the following repositories -</p><ul><li><a href="https://github.com/ChainSafe/chainbridge-deploy" target="_blank" rel="noopener noreferrer">ChainSafe/chainbridge-deploy</a> - This will help us in setting up of our bridge contracts</li><li><a href="https://github.com/ChainSafe/ChainBridge" target="_blank" rel="noopener noreferrer">ChainSafe/chainbridge</a> - This will help us in setting up of our off-chain relayer.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="installing-chainbridge-command-line-tool">Installing Chainbridge Command Line Tool<a class="hash-link" href="#installing-chainbridge-command-line-tool" title="Direct link to heading">​</a></h3><p>Using the following command, we can clone and install Chainbridge&#x27;s command-line tool. This will help us in setting up bridge contracts and demonstrating bridge transfers. Once the bridge contracts are deployed, you can use its ABI and contract address to set up your UI.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone -b v1.0.0 --depth </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> https://github.com/ChainSafe/chainbridge-deploy </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token builtin class-name">cd</span><span class="token plain"> chainbridge-deploy/cb-sol-cli </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will build the contracts and installs the <code>cb-sol-cli</code> command.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-environment-variables">Setting Up Environment Variables<a class="hash-link" href="#setting-up-environment-variables" title="Direct link to heading">​</a></h3><p>Let&#x27;s set up environment variables, so that, we do not need to write their values every time we issue a command. Move back to the <code>deploy-bridge</code> directory (main project directory) and make a new file <code>configVars</code>. Put the following contents inside it -</p><div class="language-env codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-env codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SRC_GATEWAY=https://subnets.lux.network/wagmi/wagmi-chain-testnet/rpc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DST_GATEWAY=https://api.lux-test.network/ext/bc/C/rpc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SRC_ADDR=&quot;&lt;Your address on WAGMI&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SRC_PK=&quot;&lt;your private key on WAGMI&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DST_ADDR=&quot;&lt;Your address on Fuji&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DST_PK=&quot;&lt;your private key on Fuji&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SRC_TOKEN=&quot;0x3Ee7094DADda15810F191DD6AcF7E4FFa37571e4&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RESOURCE_ID=&quot;0x00&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>SRC_ADDR</code> and <code>DST_ADDR</code> are the addresses that will deploy bridge contracts and will act as a relayer.</li><li><code>SRC_TOKEN</code> is the token that we want to bridge. Here is the address of the wrapped ERC20 version of the WGM coin aka wWGM.</li><li><code>RESOURCE_ID</code> could be anything. It identifies our bridged ERC20 tokens on both sides (WAGMI and Fuji).</li></ul><p>Every time we make changes to these config variables, we have to update our bash environment. Run the following command according to the relative location of the file. These variables are temporary and are only there in the current terminal session, and will be flushed, once the session is over. Make sure to load these environment variables anywhere you will using them in the bash commands (like <code>$SRC_GATEWAY</code> or <code>$SRC_ADDR</code>)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">source</span><span class="token plain"> ./configVars</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-source-chain">Setting Up Source Chain<a class="hash-link" href="#setting-up-source-chain" title="Direct link to heading">​</a></h2><p>We need to set up our source chain as follows -</p><ul><li>Deploy Bridge and Handler contract with <code>$SRC_ADDR</code> as default and only relayer</li><li>Register the <code>wWGM</code> token as a resource on the bridge</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-contracts">Deploy contracts<a class="hash-link" href="#deploy-contracts" title="Direct link to heading">​</a></h3><p>The command-line tool <code>cb-sol-cli</code> will help us to deploy the contracts. Run the following command in the terminal session where the config vars are loaded. It will add <code>SRC_ADDR</code> as the default relayer for relaying events from the Wagmi chain (source) to the Fuji chain (destination).</p><p><strong>One of the most important parameter to take care of while deploying bridge contract is the <code>expiry</code> value. It is the numer of blocks after which a proposal is considered cancelled. By default it is set to <code>100</code>. On Lux mainnet, with this value, the proposals could be expired within 3-4 minutes. You should choose a very large expiry value, according to the chain you are deploying bridge to. Otherwise your proposal will be cancelled if the thereshold number of vote proposals are not received on time.</strong></p><p>You should also keep this in mind that sometimes during high network activity, a transaction could stuck for a long time. Proposal transactions stuck in this scenario, could result in the cancellation of previous proposals. Therefore, expiry values should be large enought, and relayers should issue transactions with a competitive max gas price.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cb-sol-cli --url </span><span class="token variable" style="color:#36acaa">$SRC_GATEWAY</span><span class="token plain"> --privateKey </span><span class="token variable" style="color:#36acaa">$SRC_PK</span><span class="token plain"> --gasPrice </span><span class="token number" style="color:#36acaa">25000000000</span><span class="token plain"> deploy </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --bridge --erc20Handler </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --relayers </span><span class="token variable" style="color:#36acaa">$SRC_ADDR</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --relayerThreshold </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --expiry </span><span class="token number" style="color:#36acaa">500</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --chainId </span><span class="token number" style="color:#36acaa">0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The output will return deployed contracts&#x27; (Bridge and Handler) address. Update the <code>configVars</code> file with these addresses by adding the following 2 variables and loading them to the environment.</p><div class="language-env codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-env codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SRC_BRIDGE=&quot;&lt;resulting bridge contract address&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SRC_HANDLER=&quot;&lt;resulting erc20 handler contract address&gt;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Make sure to load these using the <code>source</code> command.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-resource-on-bridge">Configure Resource on Bridge<a class="hash-link" href="#configure-resource-on-bridge" title="Direct link to heading">​</a></h3><p>Run the following command to register the <code>wWGM</code> token as a resource on the source bridge.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cb-sol-cli --url </span><span class="token variable" style="color:#36acaa">$SRC_GATEWAY</span><span class="token plain"> --privateKey </span><span class="token variable" style="color:#36acaa">$SRC_PK</span><span class="token plain"> --gasPrice </span><span class="token number" style="color:#36acaa">25000000000</span><span class="token plain"> bridge register-resource </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --bridge </span><span class="token variable" style="color:#36acaa">$SRC_BRIDGE</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --handler </span><span class="token variable" style="color:#36acaa">$SRC_HANDLER</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --resourceId </span><span class="token variable" style="color:#36acaa">$RESOURCE_ID</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --targetContract </span><span class="token variable" style="color:#36acaa">$SRC_TOKEN</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-destination-chain">Setting Up Destination Chain<a class="hash-link" href="#setting-up-destination-chain" title="Direct link to heading">​</a></h2><p>We need to set up our destination chain as follows -</p><ul><li>Deploy Bridge and Handler contract with <code>$DST_ADDR</code> as default and only relayer</li><li>Deploy mintable and burnable ERC20 contract representing bridged <code>wWGM</code> token</li><li>Register the <code>wWGM</code> token as a resource on the bridge</li><li>Register the<code> wWGM</code> token as mintable/burnable on the bridge</li><li>Giving permissions to Handler contract to mint new <code>wWGM</code> tokens</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-contracts-1">Deploy Contracts<a class="hash-link" href="#deploy-contracts-1" title="Direct link to heading">​</a></h3><p>Run the following command to deploy Bridge, ERC20 Handler, and <code>wWGM</code> token contracts on the Fuji chain. Again it will set <code>DST_ADDR</code> as the default relayer for relaying events from Fuji chain (destination) to Wagmi chain (source). For this example, both <code>SRC_ADDR</code> and <code>DST_ADDR</code> represent the same thing.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cb-sol-cli --url </span><span class="token variable" style="color:#36acaa">$DST_GATEWAY</span><span class="token plain"> --privateKey </span><span class="token variable" style="color:#36acaa">$DST_PK</span><span class="token plain"> --gasPrice </span><span class="token number" style="color:#36acaa">25000000000</span><span class="token plain"> deploy</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --bridge --erc20 --erc20Handler </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --relayers </span><span class="token variable" style="color:#36acaa">$DST_ADDR</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --relayerThreshold </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --chainId </span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Update the environment variables with the details which you will get by running the above command. Don&#x27;t forget to load these variables.</p><div class="language-env codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-env codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">DST_BRIDGE=&quot;&lt;resulting bridge contract address&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DST_HANDLER=&quot;&lt;resulting erc20 handler contract address&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DST_TOKEN=&quot;&lt;resulting erc20 token address&gt;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-resource-on-bridge">Configuring Resource on Bridge<a class="hash-link" href="#configuring-resource-on-bridge" title="Direct link to heading">​</a></h3><p>Run the following command to register deployed <code>wWGM</code> token as a resource on the bridge.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cb-sol-cli --url </span><span class="token variable" style="color:#36acaa">$DST_GATEWAY</span><span class="token plain"> --privateKey </span><span class="token variable" style="color:#36acaa">$DST_PK</span><span class="token plain"> --gasPrice </span><span class="token number" style="color:#36acaa">25000000000</span><span class="token plain"> bridge register-resource </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --bridge </span><span class="token variable" style="color:#36acaa">$DST_BRIDGE</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --handler </span><span class="token variable" style="color:#36acaa">$DST_HANDLER</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --resourceId </span><span class="token variable" style="color:#36acaa">$RESOURCE_ID</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --targetContract </span><span class="token variable" style="color:#36acaa">$DST_TOKEN</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="setting-token-as-mintable-and-burnable-on-bridge">Setting Token as Mintable and Burnable on Bridge<a class="hash-link" href="#setting-token-as-mintable-and-burnable-on-bridge" title="Direct link to heading">​</a></h3><p>The bridge has two options when it receives a deposit of a token -</p><ul><li>Lock the received token on one chain and mint the corresponding token on the other chain</li><li>Burn the received token on one chain and release the corresponding token on the other chain</li></ul><p>We cannot mint or burn any token which we do not control. Though we can lock and release such tokens by putting them in a token safe. The bridge has to know which token it can burn. With the following command, we can set the resource as burnable. The bridge will choose the action accordingly, by seeing the token as burnable or not.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cb-sol-cli --url </span><span class="token variable" style="color:#36acaa">$DST_GATEWAY</span><span class="token plain"> --privateKey </span><span class="token variable" style="color:#36acaa">$DST_PK</span><span class="token plain"> --gasPrice </span><span class="token number" style="color:#36acaa">25000000000</span><span class="token plain"> bridge set-burn </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --bridge </span><span class="token variable" style="color:#36acaa">$DST_BRIDGE</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --handler </span><span class="token variable" style="color:#36acaa">$DST_HANDLER</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --tokenContract </span><span class="token variable" style="color:#36acaa">$DST_TOKEN</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="authorizing-handler-to-mint-new-tokens">Authorizing Handler to Mint New Tokens<a class="hash-link" href="#authorizing-handler-to-mint-new-tokens" title="Direct link to heading">​</a></h3><p>Now let&#x27;s permit the handler to mint the deployed ERC20 (wWGM) token on the destination chain. Run the following command.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cb-sol-cli --url </span><span class="token variable" style="color:#36acaa">$DST_GATEWAY</span><span class="token plain"> --privateKey </span><span class="token variable" style="color:#36acaa">$DST_PK</span><span class="token plain"> --gasPrice </span><span class="token number" style="color:#36acaa">25000000000</span><span class="token plain"> erc20 add-minter </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --minter </span><span class="token variable" style="color:#36acaa">$DST_HANDLER</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --erc20Address </span><span class="token variable" style="color:#36acaa">$DST_TOKEN</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><strong>The deployer of the contracts (here <code>SRC_ADDR</code> or <code>DST_ADDR</code>) holds the admin rights. An admin can add or remove a new relayer, minter, admin etc. It can also mint new ERC20 tokens on the destination chain. You can issue these commands using <code>cb-sol-cli</code> with the options mentioned in these <a href="https://github.com/ChainSafe/chainbridge-deploy/tree/main/cb-sol-cli/docs" target="_blank" rel="noopener noreferrer">files</a>. The mint command should not be used manually, unless some intervention is required, when the relayers failed to mint the tokens on the destination chain on time.</strong></p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-relayer">Deploy Relayer<a class="hash-link" href="#deploy-relayer" title="Direct link to heading">​</a></h2><p>All the on-chain setups like deploying bridges, handlers, tokens, etc. are complete. But the two chains are not interconnected. We need some off-chain relayer to communicate messages between the chains. The relayer will poll for deposit events on one chain, and submit vote proposals to mint or release the corresponding token on another chain.</p><p>Since we set the relayer threshold to 1, while deploying the bridge and handler, we require a voting proposal from only 1 relayer. But in production, we should use a large set of relayers with a high threshold to avoid power concentration.</p><p>For this purpose, we will be using Chainsafe&#x27;s relayer. Follow the steps described below to deploy the relayer.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cloning-and-building-relayer">Cloning and Building Relayer<a class="hash-link" href="#cloning-and-building-relayer" title="Direct link to heading">​</a></h3><p>Open a new terminal session, while keeping the previous session loaded with environment variables. We have to load the environment variables in this session too. Load these variables in this session too using the <code>source</code> command.</p><p>Now, move to the <code>deploy-bridge</code> directory and run the following command to clone the relayer repo (implemented in Go), and build its binary.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone -b v1.1.1 --depth </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> https://github.com/ChainSafe/chainbridge </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token builtin class-name">cd</span><span class="token plain"> chainbridge </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> build</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will create a binary inside the <code>chainbridge/build</code> directory as <code>chainbridge</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-relayer">Configuring Relayer<a class="hash-link" href="#configuring-relayer" title="Direct link to heading">​</a></h3><p>The relayer requires some configurations like source chain, destination chain, bridge, handler address, etc. Run the following command. It will make a <code>config.json</code> file with the required details in it. You can update these details, as per your need.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">chains</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">name</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">WAGMI</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">type</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">ethereum</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">id</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">0</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">endpoint</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string variable" style="color:#36acaa">$SRC_GATEWAY</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">from</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string variable" style="color:#36acaa">$SRC_ADDR</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">opts</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">bridge</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string variable" style="color:#36acaa">$SRC_BRIDGE</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">erc20Handler</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string variable" style="color:#36acaa">$SRC_HANDLER</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">genericHandler</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string variable" style="color:#36acaa">$SRC_HANDLER</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">gasLimit</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">1000000</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">maxGasPrice</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">50000000000</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">http</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">true</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">blockConfirmations</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">:</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">0</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">name</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">Fuji</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">type</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">ethereum</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">id</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">1</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">endpoint</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string variable" style="color:#36acaa">$DST_GATEWAY</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">from</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string variable" style="color:#36acaa">$DST_ADDR</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">opts</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">bridge</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string variable" style="color:#36acaa">$DST_BRIDGE</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">erc20Handler</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string variable" style="color:#36acaa">$DST_HANDLER</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">genericHandler</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string variable" style="color:#36acaa">$DST_HANDLER</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">gasLimit</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">1000000</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">maxGasPrice</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">50000000000</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">http</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">true</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">blockConfirmations</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">:</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">0</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> config.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Check and confirm the details in the <code>config.json</code> file.</p><blockquote><p>In the above command, you can see that <code>blockConfirmations</code> is set to <code>0</code>. This will work well for networks like Lux because the block is confirmed once it&#x27;s committed. Unlike other chains such as Ethereum, which requires 20-30 block confirmations. Therefore, use this configuration with caution, depending on the type of chain you are using.</p><p>It can cause serious problems if a corresponding token is minted or released based on an unconfirmed block.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="set-up-keys">Set Up Keys<a class="hash-link" href="#set-up-keys" title="Direct link to heading">​</a></h3><p>Give relayer access to your keys. Using these keys, the relayer will propose deposit events and execute proposals. It will ask to set a password for encrypting these keys. Every time you start the relayer, it will ask for this password.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./build/chainbridge accounts </span><span class="token function" style="color:#d73a49">import</span><span class="token plain"> --privateKey </span><span class="token variable" style="color:#36acaa">$SRC_PK</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./build/chainbridge accounts </span><span class="token function" style="color:#d73a49">import</span><span class="token plain"> --privateKey </span><span class="token variable" style="color:#36acaa">$DST_PK</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lets-test-the-bridge">Let&#x27;s Test the Bridge<a class="hash-link" href="#lets-test-the-bridge" title="Direct link to heading">​</a></h2><p>The setup is now complete - both on-chain and off-chain. Now we just have to start the relayer and test the bridge. For testing purposes, we will be using <code>cb-sol-cli</code> to make deposit transactions on the bridge. But you can make your front end and integrate it with the bridge using the ABIs.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="start-relayer">Start Relayer<a class="hash-link" href="#start-relayer" title="Direct link to heading">​</a></h3><p>Run the following command to start the relayer. It will print logs of all the events associated with our bridge, happening on both the chains. So keep the relayer running and follow the next commands in the other terminal session.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./build/chainbridge --config config.json --verbosity trace --latest</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="approve-handler-to-spend-my-tokens">Approve Handler to Spend my Tokens<a class="hash-link" href="#approve-handler-to-spend-my-tokens" title="Direct link to heading">​</a></h3><p>Now, let&#x27;s deposit tokens on the WAGMI bridge. But before that, we need to approve the handler to spend (lock or burn) tokens on our (here <code>SRC_PK</code>) behalf. The amount here is in Wei (1 ether (WGM) = 10^18 Wei). We will be approving 0.1 wWGM.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cb-sol-cli --url </span><span class="token variable" style="color:#36acaa">$SRC_GATEWAY</span><span class="token plain"> --privateKey </span><span class="token variable" style="color:#36acaa">$SRC_PK</span><span class="token plain"> --gasPrice </span><span class="token number" style="color:#36acaa">25000000000</span><span class="token plain"> erc20 approve </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --amount </span><span class="token number" style="color:#36acaa">100000000000000000</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --erc20Address </span><span class="token variable" style="color:#36acaa">$SRC_TOKEN</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --recipient </span><span class="token variable" style="color:#36acaa">$SRC_HANDLER</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="deposit-tokens-to-the-bridge">Deposit Tokens to the Bridge<a class="hash-link" href="#deposit-tokens-to-the-bridge" title="Direct link to heading">​</a></h3><p>Once approved, we can send a deposit transaction. Now let&#x27;s deposit 0.1 wWGM on the bridge. The handler will lock (transfer to token safe) 0.1 wWGM from our address (here <code>SRC_PK</code>) and mint the new tokens on the destination chain to the recipient (here <code>DST_ADDR</code>).</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cb-sol-cli --url </span><span class="token variable" style="color:#36acaa">$SRC_GATEWAY</span><span class="token plain"> --privateKey </span><span class="token variable" style="color:#36acaa">$SRC_PK</span><span class="token plain"> --gasPrice </span><span class="token number" style="color:#36acaa">25000000000</span><span class="token plain"> erc20 deposit </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --amount </span><span class="token number" style="color:#36acaa">100000000000000000</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --dest </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --bridge </span><span class="token variable" style="color:#36acaa">$SRC_BRIDGE</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --recipient </span><span class="token variable" style="color:#36acaa">$DST_ADDR</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --resourceId </span><span class="token variable" style="color:#36acaa">$RESOURCE_ID</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This transaction will transfer 0.1 wWGM to token safe and emit a <code>Deposit</code> event, which will be captured by the relayer. Following this event, it will send a voting proposal to the destination chain. Since the threshold is 1, the bridge will execute the proposal, and new wWGM minted to the recipient&#x27;s address. Here is the screenshot of the output from the relayer.</p><p><img loading="lazy" src="/assets/images/chainsafe-bridge-2-relayer-output-47d1c545466048dcd36585c421e2d9a3.png" width="3434" height="1096" class="img_ev3q"></p><p>Similarly, we can transfer the tokens back to the WAGMI chain.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">​</a></h2><p>Similar to the above process, you can deploy a bridge between any 2 EVM-based chains. We have used the command-line tool to make approvals and deposits. This can be further extended to build a frontend integrated with the bridge. Currently, it depends on a single relayer, which is not secure. We need a large set of relayers and a high threshold to avoid any kind of centralization.</p><p>You can learn more about these contracts and implementations by reading ChainSafe&#x27;s <a href="https://chainbridge.chainsafe.io/" target="_blank" rel="noopener noreferrer">Chainbridge</a> documentation.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/luxdefi/network-docs/edit/main/docs/subnets/deploying-cross-chain-evm-bridge.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/subnets/subnet-cli"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Subnet CLI</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/subnets/network-runner"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Lux Network Runner</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#workflow-of-the-bridge" class="table-of-contents__link toc-highlight">Workflow of the Bridge</a></li><li><a href="#requirements" class="table-of-contents__link toc-highlight">Requirements</a></li><li><a href="#setting-up-environment" class="table-of-contents__link toc-highlight">Setting Up Environment</a><ul><li><a href="#installing-chainbridge-command-line-tool" class="table-of-contents__link toc-highlight">Installing Chainbridge Command Line Tool</a></li><li><a href="#setting-up-environment-variables" class="table-of-contents__link toc-highlight">Setting Up Environment Variables</a></li></ul></li><li><a href="#setting-up-source-chain" class="table-of-contents__link toc-highlight">Setting Up Source Chain</a><ul><li><a href="#deploy-contracts" class="table-of-contents__link toc-highlight">Deploy contracts</a></li><li><a href="#configure-resource-on-bridge" class="table-of-contents__link toc-highlight">Configure Resource on Bridge</a></li></ul></li><li><a href="#setting-up-destination-chain" class="table-of-contents__link toc-highlight">Setting Up Destination Chain</a><ul><li><a href="#deploy-contracts-1" class="table-of-contents__link toc-highlight">Deploy Contracts</a></li><li><a href="#configuring-resource-on-bridge" class="table-of-contents__link toc-highlight">Configuring Resource on Bridge</a></li><li><a href="#setting-token-as-mintable-and-burnable-on-bridge" class="table-of-contents__link toc-highlight">Setting Token as Mintable and Burnable on Bridge</a></li><li><a href="#authorizing-handler-to-mint-new-tokens" class="table-of-contents__link toc-highlight">Authorizing Handler to Mint New Tokens</a></li></ul></li><li><a href="#deploy-relayer" class="table-of-contents__link toc-highlight">Deploy Relayer</a><ul><li><a href="#cloning-and-building-relayer" class="table-of-contents__link toc-highlight">Cloning and Building Relayer</a></li><li><a href="#configuring-relayer" class="table-of-contents__link toc-highlight">Configuring Relayer</a></li><li><a href="#set-up-keys" class="table-of-contents__link toc-highlight">Set Up Keys</a></li></ul></li><li><a href="#lets-test-the-bridge" class="table-of-contents__link toc-highlight">Let&#39;s Test the Bridge</a><ul><li><a href="#start-relayer" class="table-of-contents__link toc-highlight">Start Relayer</a></li><li><a href="#approve-handler-to-spend-my-tokens" class="table-of-contents__link toc-highlight">Approve Handler to Spend my Tokens</a></li><li><a href="#deposit-tokens-to-the-bridge" class="table-of-contents__link toc-highlight">Deposit Tokens to the Bridge</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://chat.lux.network" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/luxdefi" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://t.me/luxdefi" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://medium.com/luxdefi" target="_blank" rel="noopener noreferrer" class="footer__link-item">Medium<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://youtube.com/luxdefi" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://ecosystem.lux.network" target="_blank" rel="noopener noreferrer" class="footer__link-item">Ecosystem<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/luxdefi/network-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Lux Partners Limited</div></div></div></footer></div>
<script src="/assets/js/runtime~main.bb3b2830.js"></script>
<script src="/assets/js/main.199c8d31.js"></script>
</body>
</html>