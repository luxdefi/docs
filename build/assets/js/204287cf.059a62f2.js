"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4689],{34575:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>d,frontMatter:()=>c,metadata:()=>i,toc:()=>u});var s=t(85893),a=t(11151);const c={},r="Auction.js",i={id:"deprecated/tutorials-contest/2021/drizzle-auction-manager/frontend/Auction.js",title:"Auction.js",description:"",source:"@site/docs/deprecated/tutorials-contest/2021/drizzle-auction-manager/frontend/Auction.js.md",sourceDirName:"deprecated/tutorials-contest/2021/drizzle-auction-manager/frontend",slug:"/deprecated/tutorials-contest/2021/drizzle-auction-manager/frontend/Auction.js",permalink:"/deprecated/tutorials-contest/2021/drizzle-auction-manager/frontend/Auction.js",draft:!1,unlisted:!1,editUrl:"https://github.com/luxdefi/docs/edit/main/docs/deprecated/tutorials-contest/2021/drizzle-auction-manager/frontend/Auction.js.md",tags:[],version:"current",frontMatter:{}},o={},u=[];function l(e){const n={code:"code",h1:"h1",pre:"pre",...(0,a.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"auctionjs",children:"Auction.js"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:'import React, { useState, useEffect } from "react";\nimport { useDrizzleContext } from \'./drizzleContext\';\nimport FetchAuctions from \'./AuctionList\';\nimport CreateAuction from \'./CreateAuction\';\n\nfunction Auction() {\n    // Importing drizzle variables from drizzle context\n    const { drizzleVariables } = useDrizzleContext();\n    const { AuctionManager, subscriber, accounts } = drizzleVariables;\n\n    // Setting up cache keys corresponding to cache calls\n    const [cacheKeys, setCacheKey] = useState({\n        uId: null,\n        aId: null,\n        showAuctions: null,\n        isRegistered: null,\n        auctionAnalytics: [null]\n    });\n    const [auctionAnalyticsCacheKey, setAuctionAnalyticsCacheKey] = useState(null);\n\n    // Setting up cache calls for requried functions\n    const cacheCalls = {\n        isRegistered: subscriber?.isRegistered[cacheKeys?.isRegistered]?.value,\n        user: subscriber?.users[cacheKeys?.uId]?.value,\n        aId: subscriber?.aId[cacheKeys?.aId]?.value,\n        showAuctions: subscriber?.showAuctions[cacheKeys?.showAuctions]?.value,\n        auctionAnalytics: []\n    }\n\n    for(let i = 0; i < cacheCalls.aId; i++) {\n        cacheCalls.auctionAnalytics.push(subscriber?.auctionAnalytics[auctionAnalyticsCacheKey[i]]?.value)\n    }\n\n    const [isRegistered, setIsRegistered] = useState(false);\n    const [userInfo, setUserInfo] = useState({\n        id: null,\n        name: null\n    });\n\n    // Initializing cache keys\n    useEffect(() => {\n        const _auctionCacheKey = AuctionManager?.showAuctions?.cacheCall()\n        const _aIdCacheKey = AuctionManager?.aId?.cacheCall()\n        const _isRegistered = AuctionManager?.isRegistered?.cacheCall(accounts[0])\n        setCacheKey({\n            ...cacheKeys,\n            showAuctions: _auctionCacheKey,\n            aId: _aIdCacheKey,\n            isRegistered: _isRegistered\n        })\n    }, []);\n\n    useEffect(() => {\n        let _auctionAnalyticsCacheKey = [];\n        for(let i = 0; i < cacheCalls.aId; i++) {\n            _auctionAnalyticsCacheKey.push(AuctionManager?.auctionAnalytics?.cacheCall(i))\n        }\n        setAuctionAnalyticsCacheKey(_auctionAnalyticsCacheKey)\n    }, [cacheCalls.aId])\n\n    useEffect(() => {\n        if(cacheCalls.isRegistered !== undefined && cacheCalls.isRegistered[0] == 1) {\n            setIsRegistered(true);\n            (async () => {\n                const userInfo = await AuctionManager.users(cacheCalls.isRegistered[1]).call()\n                setUserInfo({\n                    id: userInfo.userId,\n                    name: userInfo.name\n                })\n            })();\n        } else {\n            setIsRegistered(false)\n        }\n    }, [cacheCalls.isRegistered]);\n\n    const createUser = async (name) => {\n        await AuctionManager?.createUser(name)?.send({from: accounts[0]})\n    }\n\n    const [userName, setUserName] = useState("");\n\n    const handleUserNameChange = (event) => {\n        setUserName(event.target.value)\n    }\n\n    const submitLogin = event => {\n        event.preventDefault()\n        createUser(userName)\n    }\n\n    const UserInfo = () => {\n        return (\n            <div>\n                <label style={{color: "red"}}>ID: </label> {userInfo.id}\n                <label style={{marginLeft: "50px", color: "green"}}>Name: </label> {userInfo.name} <br/><br/>\n            </div>\n        )\n    }\n\n    return (\n        <div>\n            <h1>Auctions</h1>\n            {\n                isRegistered\n                ? \n                <>\n                    <UserInfo/>\n                    <FetchAuctions cacheCalls={cacheCalls} userInfo={userInfo}/> <br/><br/>\n                    <CreateAuction/>\n                </>\n                : \n                <form onSubmit={submitLogin}>\n                    <font color="red" font="2">This address is not yet registered!</font><br/><br/>\n                    <label>Address: </label><input disabled value={accounts[0]}/><br/><br/>\n                    <label>Name: </label><input key="1" value={userName} required onChange={handleUserNameChange} placeholder="Enter your name"/><br/><br/>\n                    <input type="submit" value="Register" />\n                </form>              \n            }\n        </div>\n    )\n}\n\nexport default Auction;\n'})})]})}function d(e={}){const{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},11151:(e,n,t)=>{t.d(n,{Z:()=>i,a:()=>r});var s=t(67294);const a={},c=s.createContext(a);function r(e){const n=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);