"use strict";(self.webpackChunklux_docs=self.webpackChunklux_docs||[]).push([[2015],{3905:function(e,t,a){a.d(t,{Zo:function(){return p},kt:function(){return m}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),c=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},p=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=c(a),m=r,h=d["".concat(l,".").concat(m)]||d[m]||u[m]||o;return a?n.createElement(h,s(s({ref:t},p),{},{components:a})):n.createElement(h,s({ref:t},p))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,s=new Array(o);s[0]=d;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:r,s[1]=i;for(var c=2;c<o;c++)s[c]=a[c];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},6661:function(e,t,a){a.r(t),a.d(t,{assets:function(){return p},contentTitle:function(){return l},default:function(){return m},frontMatter:function(){return i},metadata:function(){return c},toc:function(){return u}});var n=a(7462),r=a(3366),o=(a(7294),a(3905)),s=["components"],i={},l="Add Lux to MetaMask Programmatically",c={unversionedId:"dapps/smart-contracts/add-lux-to-metamask-programmatically",id:"dapps/smart-contracts/add-lux-to-metamask-programmatically",title:"Add Lux to MetaMask Programmatically",description:"Adding new networks to Metamask is not a trivial task for people that are not technically savvy, and it can be error prone. To help easier onboarding of users to your application it is useful to simplify that process as much as possible. This tutorial will show how to build a simple button in your front-end application that will automate the process of adding the Lux network to MetaMask.",source:"@site/docs/dapps/smart-contracts/add-lux-to-metamask-programmatically.md",sourceDirName:"dapps/smart-contracts",slug:"/dapps/smart-contracts/add-lux-to-metamask-programmatically",permalink:"/dapps/smart-contracts/add-lux-to-metamask-programmatically",draft:!1,editUrl:"https://github.com/luxdefi/network-docs/edit/main/docs/dapps/smart-contracts/add-lux-to-metamask-programmatically.md",tags:[],version:"current",frontMatter:{},sidebar:"dapps",previous:{title:"Verify Smart Contracts on the C-Chain Explorer",permalink:"/dapps/smart-contracts/verify-smart-contracts"}},p={},u=[{value:"EIP-3035 &amp; MetaMask",id:"eip-3035--metamask",level:2},{value:"Data Structures",id:"data-structures",level:2},{value:"Adding the Network",id:"adding-the-network",level:2},{value:"User Experience",id:"user-experience",level:2},{value:"Conclusion",id:"conclusion",level:2}],d={toc:u};function m(e){var t=e.components,i=(0,r.Z)(e,s);return(0,o.kt)("wrapper",(0,n.Z)({},d,i,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"add-lux-to-metamask-programmatically"},"Add Lux to MetaMask Programmatically"),(0,o.kt)("p",null,"Adding new networks to Metamask is not a trivial task for people that are not technically savvy, and it can be error prone. To help easier onboarding of users to your application it is useful to simplify that process as much as possible. This tutorial will show how to build a simple button in your front-end application that will automate the process of adding the Lux network to MetaMask."),(0,o.kt)("h2",{id:"eip-3035--metamask"},"EIP-3035 & MetaMask"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://eips.ethereum.org/EIPS/eip-3085"},"EIP-3035")," is an ",(0,o.kt)("a",{parentName:"p",href:"https://eips.ethereum.org/"},"Ethereum Improvement Proposal")," that defines an RPC method for adding Ethereum-compatible chains to wallet applications."),(0,o.kt)("p",null,"Since March 2021 Metamask has implemented that EIP as part of their Metamask ",(0,o.kt)("a",{parentName:"p",href:"https://consensys.net/blog/metamask/connect-users-to-layer-2-networks-with-the-metamask-custom-networks-api/"},"Custom Networks API"),"."),(0,o.kt)("p",null,"Let's see how it works."),(0,o.kt)("h2",{id:"data-structures"},"Data Structures"),(0,o.kt)("p",null,"To add the Lux network to Metamask, we need to prepare the data structures that will be contain all the necessary data."),(0,o.kt)("p",null,"Main network data:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'export const LUX_MAINNET_PARAMS = {\n  chainId: "0xA86A",\n  chainName: "Lux Mainnet C-Chain",\n  nativeCurrency: {\n    name: "Lux",\n    symbol: "LUX",\n    decimals: 18,\n  },\n  rpcUrls: ["https://api.lux.network/ext/bc/C/rpc"],\n  blockExplorerUrls: ["https://snowtrace.io/"],\n}\n')),(0,o.kt)("p",null,"Test network data:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'export const LUX_TESTNET_PARAMS = {\n  chainId: "0xA869",\n  chainName: "Lux Testnet C-Chain",\n  nativeCurrency: {\n    name: "Lux",\n    symbol: "LUX",\n    decimals: 18,\n  },\n  rpcUrls: ["https://api.lux-test.network/ext/bc/C/rpc"],\n  blockExplorerUrls: ["https://testnet.snowtrace.io/"],\n}\n')),(0,o.kt)("h2",{id:"adding-the-network"},"Adding the Network"),(0,o.kt)("p",null,"To add the network to MetaMask, we need to call the ",(0,o.kt)("inlineCode",{parentName:"p"},"wallet_addEthereumChain")," method, exposed by the web3 provider."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'function addLuxNetwork() {\n  injected.getProvider().then((provider) => {\n    provider\n      .request({\n        method: "wallet_addEthereumChain",\n        params: [LUX_MAINNET_PARAMS],\n      })\n      .catch((error: any) => {\n        console.log(error)\n      })\n  })\n}\n')),(0,o.kt)("p",null,"Where ",(0,o.kt)("inlineCode",{parentName:"p"},"injected")," is initialized as a ",(0,o.kt)("inlineCode",{parentName:"p"},"web3-react/injected-connector")," used to interface with MetaMask APIs. Usage for other popular web frameworks is similar. Replace ",(0,o.kt)("inlineCode",{parentName:"p"},"LUX_MAINNET_PARAMS")," with ",(0,o.kt)("inlineCode",{parentName:"p"},"LUX_TESTNET_PARAMS")," if you want to add the test network."),(0,o.kt)("p",null,"Typical usage pattern would be to expose a button calling that method if you get ",(0,o.kt)("inlineCode",{parentName:"p"},"Wrong Network")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"Error connecting")," errors when attempting to establish a connection to MetaMask."),(0,o.kt)("h2",{id:"user-experience"},"User Experience"),(0,o.kt)("p",null,"When users first come to your dapp's website they need to approve connection to MetaMask. After they do that, if you don't detect successful web3 network connection, you can present them with a dialog asking them to confirm switch to a new network:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"wrong network",src:a(4195).Z,width:"407",height:"201"})),(0,o.kt)("p",null,"If they press the button, they are shown a dialog from MetaMask asking for approval to add the new network:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"add a network",src:a(5399).Z,width:"404",height:"679"})),(0,o.kt)("p",null,"If they approve, your app will be connected to the Lux network. Very easy, no need for any data entry, no chance of wrong data entry. And that's it, users are ready to interacy with your dapp!"),(0,o.kt)("h2",{id:"conclusion"},"Conclusion"),(0,o.kt)("p",null,"Dapps users are often not very technically sophisticated and onboarding them needs to be as seamless and easy as possible. Manually adding a new network to MetaMask is a hurdle than a certain percentage of your potential users will not be able to clear. Removing that requirement is a simple step that will enhance their experience and enable more users to get to actually use your dapp."),(0,o.kt)("p",null,"If you have any questions, problems, or ideas on how to improve, or simply want to join our developer community, you can contact us on our ",(0,o.kt)("a",{parentName:"p",href:"https://chat.lux.network/"},"Discord")," server."))}m.isMDXComponent=!0},4195:function(e,t,a){t.Z=a.p+"assets/images/add-lux-to-metamask-01-wrong-network-754515e90ee8ea525e00d67abc7ad65e.png"},5399:function(e,t,a){t.Z=a.p+"assets/images/add-lux-to-metamask-02-add-network-37da9492d32dfc0355075c7c563d7e4f.png"}}]);