<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-specs/cryptographic-primitives">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-126268251-10","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>


<link rel="search" type="application/opensearchdescription+xml" title="Lux Network Documentation" href="/opensearch.xml">
<script src="scripts/intercom-app.js"></script>
<script src="scripts/intercom-scripts.js"></script><title data-rh="true">Cryptographic Primitives | Lux Network Documentation</title><meta data-rh="true" property="og:image" content="https://docs.lux.network/img/Lux-OG-Image.png?force-reload-1"><meta data-rh="true" name="twitter:image" content="https://docs.lux.network/img/Lux-OG-Image.png?force-reload-1"><meta data-rh="true" property="og:url" content="https://docs.lux.network/specs/cryptographic-primitives"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:description" content="Lux is the only regulatrd smart contracts platform in the blockchain industry, and has the most value securing its activity of any proof-of-stake protocol."><meta data-rh="true" name="twitter:title" content="Developer Documentation and Tutorials for Lux Network"><meta data-rh="true" name="keywords" content="Developer Documentation and Tutorials for Lux Network"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Cryptographic Primitives | Lux Network Documentation"><meta data-rh="true" name="description" content="Lux uses a variety of cryptographic primitives for its different functions. This file summarizes the type and kind of cryptography used at the network and blockchain layers."><meta data-rh="true" property="og:description" content="Lux uses a variety of cryptographic primitives for its different functions. This file summarizes the type and kind of cryptography used at the network and blockchain layers."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.lux.network/specs/cryptographic-primitives"><link data-rh="true" rel="alternate" href="https://docs.lux.network/specs/cryptographic-primitives" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.lux.network/specs/cryptographic-primitives" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://Z0LRBDMQFT-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.ab583772.css">
<link rel="preload" href="/assets/js/runtime~main.bb3b2830.js" as="script">
<link rel="preload" href="/assets/js/main.199c8d31.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/LuxLogo.svg" alt="Lux Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/LuxLogoWhite.svg" alt="Lux Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/">Overview</a><a class="navbar__item navbar__link" href="/quickstart">Quick Start</a><a class="navbar__item navbar__link" href="/dapps/launch-your-ethereum-dapp">DApps</a><a class="navbar__item navbar__link" href="/subnets">Subnets</a><a class="navbar__item navbar__link" href="/apis/luxd">APIs</a><a class="navbar__item navbar__link" href="/nodes">Nodes</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/specs/coreth-arc20s">Specs</a><a class="navbar__item navbar__link" href="/community">Community</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/specs/cryptographic-primitives" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/specs/coreth-arc20s">Lux Native Tokens and ARC-20s</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/specs/avm-transaction-serialization">AVM Transaction Format</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/specs/coreth-atomic-transaction-serialization">Coreth Atomic Transaction Format</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/specs/cryptographic-primitives">Cryptographic Primitives</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/specs/network-protocol">Network Protocol</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/specs/serialization-primitives">Serialization Primitives</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/specs/platform-transaction-serialization">Platform Transaction Format</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/specs/abigen">Abigen</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Cryptographic Primitives</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Cryptographic Primitives</h1><p>Lux uses a variety of cryptographic primitives for its different functions. This file summarizes the type and kind of cryptography used at the network and blockchain layers.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cryptography-in-the-network-layer">Cryptography in the Network Layer<a class="hash-link" href="#cryptography-in-the-network-layer" title="Direct link to heading">​</a></h2><p>Lux uses Transport Layer Security, TLS, to protect node-to-node communications from eavesdroppers. TLS combines the practicality of public-key cryptography with the efficiency of symmetric-key cryptography. This has resulted in TLS becoming the standard for internet communication. Whereas most classical consensus protocols employ public-key cryptography to prove receipt of messages to third parties, the novel Snow<!-- -->*<!-- --> consensus family does not require such proofs. This enables Lux to employ TLS in authenticating stakers and eliminates the need for costly public-key cryptography for signing network messages.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tls-certificates">TLS Certificates<a class="hash-link" href="#tls-certificates" title="Direct link to heading">​</a></h3><p>Lux does not rely on any centralized third-parties, and in particular, it does not use certificates issued by third-party authenticators. All certificates used within the network layer to identify endpoints are self-signed, thus creating a self-sovereign identity layer. No third parties are ever involved.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tls-addresses">TLS Addresses<a class="hash-link" href="#tls-addresses" title="Direct link to heading">​</a></h3><p>To avoid posting the full TLS certificate to the Platform chain, the certificate is first hashed. For consistency, Lux employs the same hashing mechanism for the TLS certificates as is used in Bitcoin. Namely, the DER representation of the certificate is hashed with sha256, and the result is then hashed with ripemd160 to yield a 20-byte identifier for stakers.</p><p>This 20-byte identifier is represented by &quot;NodeID-&quot; followed by the data’s <a href="https://support.lux.network/en/articles/4587395-what-is-cb58" target="_blank" rel="noopener noreferrer">CB58</a> encoded string.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cryptography-in-the-lux-virtual-machine">Cryptography in the Lux Virtual Machine<a class="hash-link" href="#cryptography-in-the-lux-virtual-machine" title="Direct link to heading">​</a></h2><p>The Lux virtual machine uses elliptic curve cryptography, specifically <code>secp256k1</code>, for its signatures on the blockchain.</p><p>This 32-byte identifier is represented by &quot;PrivateKey-&quot; followed by the data’s <a href="https://support.lux.network/en/articles/4587395-what-is-cb58" target="_blank" rel="noopener noreferrer">CB58</a> encoded string.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="secp256k1-addresses">Secp256k1 Addresses<a class="hash-link" href="#secp256k1-addresses" title="Direct link to heading">​</a></h3><p>Lux is not prescriptive about addressing schemes, choosing to instead leave addressing up to each blockchain.</p><p>The addressing scheme of the X-Chain and the P-Chain relies on secp256k1. Lux follows a similar approach as Bitcoin and hashes the ECDSA public key. The 33-byte compressed representation of the public key is hashed with sha256 <strong>once</strong>. The result is then hashed with ripemd160 to yield a 20-byte address.</p><p>Lux uses the convention <code>chainID-address</code> to specify which chain an address exists on. <code>chainID</code> may be replaced with an alias of the chain. When transmitting information through external applications, the CB58 convention is required.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bech32">Bech32<a class="hash-link" href="#bech32" title="Direct link to heading">​</a></h3><p>Addresses on the X-Chain and P-Chain use the <a href="http://support.lux.network/en/articles/4587392-what-is-bech32" target="_blank" rel="noopener noreferrer">Bech32</a> standard outlined in <a href="https://en.bitcoin.it/wiki/BIP_0173" target="_blank" rel="noopener noreferrer">BIP 0173</a>. There are four parts to a Bech32 address scheme. In order of appearance:</p><ul><li>A human-readable part (HRP). On mainnet this is <code>lux</code>.</li><li>The number <code>1</code>, which separates the HRP from the address and error correction code.</li><li>A base-32 encoded string representing the 20 byte address.</li><li>A 6-character base-32 encoded error correction code.</li></ul><p>Additionally, an Lux address is prefixed with the alias of the chain it exists on, followed by a dash. For example, X-Chain addresses are prefixed with <code>X-</code>.</p><p>The following regular expression matches addresses on the X-Chain, P-Chain and C-Chain for mainnet, fuji and localnet. Note that all valid Lux addresses will match this regular expression, but some strings that are not valid Lux addresses may match this regular expression.</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">^([XPC]|[a-km-zA-HJ-NP-Z1-9]{36,72})-[a-zA-Z]{1,83}1[qpzry9x8gf2tvdw0s3jn54khce6mua7l]{38}$</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Read more about Lux&#x27;s <a href="https://support.lux.network/en/articles/4596397-what-is-an-address" target="_blank" rel="noopener noreferrer">addressing scheme</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="secp256k1-recoverable-signatures">Secp256k1 Recoverable Signatures<a class="hash-link" href="#secp256k1-recoverable-signatures" title="Direct link to heading">​</a></h3><p>Recoverable signatures are stored as the 65-byte <strong><code>[R || S || V]</code></strong> where <strong><code>V</code></strong> is 0 or 1 to allow quick public key recoverability. <strong><code>S</code></strong> must be in the lower half of the possible range to prevent signature malleability. Before signing a message, the message is hashed using sha256.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="secp256k1-example">Secp256k1 Example<a class="hash-link" href="#secp256k1-example" title="Direct link to heading">​</a></h3><p>Suppose Rick and Morty are setting up a secure communication channel. Morty creates a new public-private key pair.</p><p>Private Key: <code>0x98cb077f972feb0481f1d894f272c6a1e3c15e272a1658ff716444f465200070</code></p><p>Public Key (33-byte compressed): <code>0x02b33c917f2f6103448d7feb42614037d05928433cb25e78f01a825aa829bb3c27</code></p><p>Because of Rick’s infinite wisdom, he doesn’t trust himself with carrying around Morty’s public key, so he only asks for Morty’s address. Morty follows the instructions, SHA256’s his public key, and then ripemd160’s that result to produce an address.</p><p>SHA256(Public Key): <code>0x28d7670d71667e93ff586f664937f52828e6290068fa2a37782045bffa7b0d2f</code></p><p>Address: <code>0xe8777f38c88ca153a6fdc25942176d2bf5491b89</code></p><p>Morty is quite confused because a public key should be safe to be public knowledge. Rick belches and explains that hashing the public key protects the private key owner from potential future security flaws in elliptic curve cryptography. In the event cryptography is broken and a private key can be derived from a public key, users can transfer their funds to an address that has never signed a transaction before, preventing their funds from being compromised by an attacker. This enables coin owners to be protected while the cryptography is upgraded across the clients.</p><p>Later, once Morty has learned more about Rick’s backstory, Morty attempts to send Rick a message. Morty knows that Rick will only read the message if he can verify it was from him, so he signs the message with his private key.</p><p>Message: <code>0x68656c702049276d207472617070656420696e206120636f6d7075746572</code></p><p>Message Hash: <code>0x912800c29d554fb9cdce579c0abba991165bbbc8bfec9622481d01e0b3e4b7da</code></p><p>Message Signature: <code>0xb52aa0535c5c48268d843bd65395623d2462016325a86f09420c81f142578e121d11bd368b88ca6de4179a007e6abe0e8d0be1a6a4485def8f9e02957d3d72da01</code></p><p>Morty was never seen again.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="signed-messages">Signed Messages<a class="hash-link" href="#signed-messages" title="Direct link to heading">​</a></h2><p>A standard for interoperable generic signed messages based on the Bitcoin Script format and Ethereum format.</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sign(sha256(length(prefix) + prefix + length(message) + message))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The prefix is simply the string <code>\x1ALux Signed Message:\n</code>, where <code>0x1A</code> is the length of the prefix text and <code>length(message)</code> is an <a href="/specs/serialization-primitives#integer">integer</a> of the message size.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="gantt-pre-image-specification">Gantt Pre-image Specification<a class="hash-link" href="#gantt-pre-image-specification" title="Direct link to heading">​</a></h3><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+-----------+------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| prefix        : [26]byte  |                     26 bytes |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+-----------+------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| messageLength : int       |                      4 bytes |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+-----------+------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| message       : []byte    |          size(message) bytes |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+-----------+------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            |       26 + 4 + size(message) |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            +------------------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example<a class="hash-link" href="#example" title="Direct link to heading">​</a></h3><p>As an example we will sign the message &quot;Through consensus to the stars&quot;</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// prefix size: 26 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x1a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// prefix: Lux Signed Message:\n</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x41 0x76 0x61 0x6c 0x61 0x6e 0x63 0x68 0x65 0x20 0x53 0x69 0x67 0x6e 0x65 0x64 0x20 0x4d 0x65 0x73 0x73 0x61 0x67 0x65 0x3a 0x0a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// msg size: 30 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00 0x00 0x00 0x1e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// msg: Through consensus to the stars</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">54 68 72 6f 75 67 68 20 63 6f 6e 73 65 6e 73 75 73 20 74 6f 20 74 68 65 20 73 74 61 72 73</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After hashing with <code>sha256</code> and signing the pre-image we return the value <a href="https://support.lux.network/en/articles/4587395-what-is-cb58" target="_blank" rel="noopener noreferrer">cb58</a> encoded: <code>4Eb2zAHF4JjZFJmp4usSokTGqq9mEGwVMY2WZzzCmu657SNFZhndsiS8TvL32n3bexd8emUwiXs8XqKjhqzvoRFvghnvSN</code>. Here&#x27;s an example using the <a href="https://wallet.lux.network/wallet/advanced" target="_blank" rel="noopener noreferrer">Lux Web Wallet</a>.</p><p><img loading="lazy" alt="Sign message" src="/assets/images/sign-message-4933bc279fd35cf1242abc38b17bbbc7.png" width="834" height="940" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cryptography-in-ethereum-virtual-machine">Cryptography in Ethereum Virtual Machine<a class="hash-link" href="#cryptography-in-ethereum-virtual-machine" title="Direct link to heading">​</a></h2><p>Lux nodes support the full Ethereum Virtual Machine (EVM) and precisely duplicate all of the cryptographic constructs used in Ethereum. This includes the Keccak hash function and the other mechanisms used for cryptographic security in the EVM.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cryptography-in-other-virtual-machines">Cryptography in Other Virtual Machines<a class="hash-link" href="#cryptography-in-other-virtual-machines" title="Direct link to heading">​</a></h2><p>Since Lux is an extensible platform, we expect that people will add additional cryptographic primitives to the system over time.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/luxdefi/network-docs/edit/main/docs/specs/cryptographic-primitives.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/specs/coreth-atomic-transaction-serialization"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Coreth Atomic Transaction Format</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/specs/network-protocol"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Network Protocol</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#cryptography-in-the-network-layer" class="table-of-contents__link toc-highlight">Cryptography in the Network Layer</a><ul><li><a href="#tls-certificates" class="table-of-contents__link toc-highlight">TLS Certificates</a></li><li><a href="#tls-addresses" class="table-of-contents__link toc-highlight">TLS Addresses</a></li></ul></li><li><a href="#cryptography-in-the-lux-virtual-machine" class="table-of-contents__link toc-highlight">Cryptography in the Lux Virtual Machine</a><ul><li><a href="#secp256k1-addresses" class="table-of-contents__link toc-highlight">Secp256k1 Addresses</a></li><li><a href="#bech32" class="table-of-contents__link toc-highlight">Bech32</a></li><li><a href="#secp256k1-recoverable-signatures" class="table-of-contents__link toc-highlight">Secp256k1 Recoverable Signatures</a></li><li><a href="#secp256k1-example" class="table-of-contents__link toc-highlight">Secp256k1 Example</a></li></ul></li><li><a href="#signed-messages" class="table-of-contents__link toc-highlight">Signed Messages</a><ul><li><a href="#gantt-pre-image-specification" class="table-of-contents__link toc-highlight">Gantt Pre-image Specification</a></li><li><a href="#example" class="table-of-contents__link toc-highlight">Example</a></li></ul></li><li><a href="#cryptography-in-ethereum-virtual-machine" class="table-of-contents__link toc-highlight">Cryptography in Ethereum Virtual Machine</a></li><li><a href="#cryptography-in-other-virtual-machines" class="table-of-contents__link toc-highlight">Cryptography in Other Virtual Machines</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://chat.lux.network" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/luxdefi" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://t.me/luxdefi" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://medium.com/luxdefi" target="_blank" rel="noopener noreferrer" class="footer__link-item">Medium<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://youtube.com/luxdefi" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://ecosystem.lux.network" target="_blank" rel="noopener noreferrer" class="footer__link-item">Ecosystem<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/luxdefi/network-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Lux Partners Limited</div></div></div></footer></div>
<script src="/assets/js/runtime~main.bb3b2830.js"></script>
<script src="/assets/js/main.199c8d31.js"></script>
</body>
</html>